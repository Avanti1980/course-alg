---
presentation:
  margin: 0
  center: false
  transition: "convex"
  enableSpeakerNotes: true
  slideNumber: "c/t"
  navigationMode: "linear"
---

@import "../css/font-awesome-4.7.0/css/font-awesome.css"
@import "../css/theme/solarized.css"
@import "../css/logo.css"
@import "../css/font.css"
@import "../css/color.css"
@import "../css/margin.css"
@import "../css/table.css"
@import "../css/main.css"
@import "../plugin/zoom/zoom.js"
@import "../plugin/customcontrols/plugin.js"
@import "../plugin/customcontrols/style.css"
@import "../plugin/chalkboard/plugin.js"
@import "../plugin/chalkboard/style.css"
@import "../plugin/menu/menu.js"

<!-- slide data-notes="" -->

<div class="bottom20"></div>

# 算法设计与分析

<hr class="width70 center">

## 函数的增长

<div class="bottom8"></div>

### 计算机学院 &nbsp;&nbsp; 张腾

#### _tengzhang@hust.edu.cn_

<!-- slide data-notes="" -->

##### 插入排序 _vs._ 归并排序

---

设对长度一千万的数组进行排序，$n = 10^7$

<div class="threelines top-2 bottom0 left8 righta">

|          |        CPU         |   算法   |     时间复杂度     |
| :------: | :----------------: | :------: | :----------------: |
| 计算机 A | $10^{10}$条指令/秒 | 插入排序 |   $2 \cdot n^2$    |
| 计算机 B |  $10^7$条指令/秒   | 归并排序 | $50 \cdot n \lg n$ |

</div>

$$
\begin{align*}
    \quad & \frac{2 \cdot (10^7)^2 \text{ instructions}}{10^{10} \text{ instructions/s}} = 20000 \text{ s} > 5.5 \text{ h} \\
    & \frac{50 \cdot 10^7 \lg 10^7 \text{ instructions}}{10^7 \text{ instructions/s}} \approx 1163 \text{ s} < 20 \text{ m}
\end{align*}
$$

<div class="top-2"></div>

两点启示：

1. 只要问题规模$n$足够大，归并排序就能胜过插入排序
2. 我们应重视算法的{==渐进效率==}，即$n \rightarrow \infty$时算法运行时间的增长速度

<!-- slide vertical=true data-notes="" -->

##### 插入排序 时间分析

---

<div class="threelines top-1 bottom-1">

| <span style="font-family:Operator">insertion_sort(a, n):</span>                                         |    时间     |                   次数                   |
| :------------------------------------------------------------------------------------------------------ | :---------: | :--------------------------------------: |
| <span style="font-family:Operator">for i in range(1, n):</span>                                         | $c_1, c'_1$ |       对$i$赋值$1$次、自增$n-1$次        |
| ^                                                                                                       |   $c''_1$   |            $i$与$n$比较$n$次             |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;key = a[i]</span>                            |    $c_2$    |            对$key$赋值$n-1$次            |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;j = i - 1</span>                             |    $c_3$    |             对$j$赋值$n-1$次             |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;while j >= 0 and key < a[j]:</span>          | $c_4,c'_4$  | 比较$2 \sum_{i=1}^{n-1} t_i + \{1,2\}$次 |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[j+1] = a[j]</span> |    $c_5$    |       赋值$\sum_{i=1}^{n-1} t_i$次       |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j -= 1</span>        |    $c_6$    |    对$j$赋值$\sum_{i=1}^{n-1} t_i$次     |
| <span style="font-family:Operator">&nbsp;&nbsp;&nbsp;&nbsp;a[j+1] = key</span>                          |    $c_7$    |               赋值$n-1$次                |

</div>

最坏情况下$T(n) = a n^2 + bn + c$，当$n \rightarrow \infty$时

- 低阶项$bn + c$相对于二次项不重要，二次项的系数$a$也不重要
- 主宰算法运行时间增长速度的就是$n^2$，因此记$T(n) = \class{blue}{\Theta(n^2)}$

<!-- slide data-notes="" -->

##### 渐进

---

某个性质渐进成立：$\exists n_0 > 0$使得对$\forall n \ge n_0$，该性质成立

- 允许在{==有限==}的区间上不成立
- 一定存在一个{==临界点==}，过了之后，在{==无限==}的区间上一直成立

<div class="top2"></div>

函数{==渐进非负==}：$\exists n_0 > 0$使得对$\forall n \ge n_0$，函数取值非负
函数{==渐进正==}：$\exists n_0 > 0$使得对$\forall n \ge n_0$，函数取值为正

$a n^2 + bn + c = \class{blue}{\Theta} (n^2)$表示在渐进意义下，即$n$充分大时，二次函数的增长速度和$n^2${==一样快==}，最多差个常数因子

$n$充分大时，二次函数和三次函数、一次函数的增长速度显然不一样快，因此$T(n) \ne \Theta(n^3)$、$T(n) \ne \Theta(n)$

<!-- slide vertical=true data-notes="" -->

##### 渐进

---

除了表示{==一样快==}(相等关系)的$\Theta$外，还有表示不等关系的

- $O$表示{==不快于==}，$o$表示{==严格慢于==}
- $\Omega$表示{==不慢于==}，$\omega$表示{==严格快于==}

<div class="threelines left8 righta">

|      | 相等关系 |   >   | 不等关系 |  >  | 严格不等关系 |
| :--: | :------: | :---: | :------: | :-: | :----------: |
| 函数 | $\Theta$ |  $O$  | $\Omega$ | $o$ |   $\omega$   |
|  数  |   $=$    | $\le$ |  $\ge$   | $<$ |     $>$      |

</div>

例：对$T(n) = 7 n^3 + 100 n^2 - 20n + 6 = \Theta(n^3)$有

- $T(n) = O(n^k)$其中$k \ge 3$，$T(n) = o(n^k)$其中$k > 3$
- $T(n) = \Omega(n^k)$其中$k \le 3$，$T(n) = \omega(n^k)$其中$k < 3$

<div class="top2"></div>

插入排序的运行时间为$O(n^2)$、$\Omega(n)$、$o(n^{2.1})$、$\omega(n^{0.99})$

<!-- slide data-notes="" -->

##### 本讲内容

---

引入 5 种限界函数刻画算法的渐进效率

<div class="threelines bottom4">

| 含义 | 渐进上界 | 渐进下界 | 渐进紧确界 | 非紧确渐进上界 | 非紧确渐进下界 |
| :--: | :------: | :------: | :--------: | :------------: | :------------: |
| 记号 |   $O$    | $\Omega$ |  $\Theta$  |      $o$       |    $\omega$    |

</div>

限界函数的严格数学定义

限界函数的各种性质和相互关系

<!-- slide data-notes="" -->

##### 渐进上界 渐进下界

---

渐进上界$O(g(n))$表示{==渐进意义==}下所有{==小于等于==}$g(n)$某个{==常数倍==}的{==非负函数==}，代表算法在{==最坏==}情况下的时间复杂度

$$
\begin{align*}
    \quad O(g(n)) = \{ f(n) \mid \exists c, n_0 > 0 ~ \forall n \ge n_0 : 0 \le f(n) \le c g(n) \}
\end{align*}
$$

渐进下界$\Omega(g(n))$表示{==渐进意义==}下所有{==大于等于==}$g(n)$某个{==常数倍==}的{==非负函数==}，代表算法在{==最好==}情况下的时间复杂度

$$
\begin{align*}
    \quad \Omega(g(n)) = \{ f(n) \mid \exists c, n_0 > 0 ~ \forall n \ge n_0 : 0 \le c g(n) \le f(n) \}
\end{align*}
$$

<div class="top2"></div>

两点说明：

1. $O(g(n))$和$\Omega(g(n))$是{==函数集合==}，$g(n)$本身也渐进非负，否则集合为空
2. $f(n) \in O(g(n))$记为$f(n) = O(g(n))$，$f(n) = \Omega(g(n))$同理，方便运算

<!-- slide vertical=true data-notes="" -->

##### 渐进上界 渐进下界

---

$d$阶多项式$p(n) = a_d n^d + a_{d-1} n^{d-1} + \cdots + a_1 n + a_0$，其中$a_d > 0$

易知有$\frac{p(n)}{n^d} = a_d + \frac{a_{d-1}}{n} + \cdots + \frac{a_1}{n^{d-1}} + \frac{a_0}{n^d} \triangleq q(n) \xrightarrow{~ n \rightarrow \infty ~} a_d$

根据极限的定义，存在$n_0$使得对$\forall n \ge n_0$有$|q(n) - a_d| \le a_d/2$，即$a_d/2 \le q(n) \le 3 a_d/2$，因此当$n \ge 1$且$k_1 \le d \le k_2$时有

$$
\begin{align*}
    \quad 0 \le \frac{a_d}{2} n^{k_1} \le \frac{a_d}{2} n^d \le p(n) \le \frac{3 a_d}{2} n^d \le \frac{3 a_d}{2} n^{k_2}
\end{align*}
$$

<div class="top-1"></div>

- 取$c = 3 a_d/2$、$n_0 = \max \{ n_0, 1 \}$，有$p(n) = O(n^k)$其中$k \ge d$
- 取$c = a_d/2$、$n_0 = \max \{ n_0, 1 \}$，有$p(n) = \Omega(n^k)$其中$k \le d$

<div class="top3"></div>

这也印证了前面的$7 n^3 + 100 n^2 - 20n + 6 = \begin{cases} O(n^k), & k \ge 3 \\ \Omega(n^k), & k \le 3 \end{cases}$

<!-- slide data-notes="" -->

##### 渐进紧确界

---

渐进紧确界$\Theta(g(n))$表示{==渐进意义==}下所有{==介于==}$g(n)$某两个{==常数倍==}之间的{==非负函数==}，代表算法在{==最坏==}情况和{==最好==}情况下的时间复杂度一样，最多差个常数因子

$$
\begin{align*}
    ~ \Theta(g(n)) = \{ f(n) \mid \exists c_1, c_2, n_0 > 0 ~ \forall n \ge n_0 : 0 \le c_1 g(n) \le f(n) \le c_2 g(n) \}
\end{align*}
$$

定理：$f(n) = \Theta(g(n))$等价于$f(n) = O(g(n))$且$f(n) = \Omega(g(n))$

正方向，$\Theta : \exists c_1, c_2, n_0 > 0 \ldots \Longrightarrow \begin{cases} O : \exists  c_2, n_0 > 0 \ldots \\ \Omega : \exists c_1, n_0  > 0 \ldots \end{cases}$

反方向，$\begin{cases} O : \exists c_2, n_2 > 0 \ldots \\ \Omega : \exists c_1, n_1 > 0 \ldots \end{cases} \Longrightarrow \Theta : \exists c_1, c_2, \max\{ n_1, n_2 \} > 0 \ldots$

<!-- slide vertical=true data-notes="" -->

##### 渐进紧确界

---

$d$阶多项式$p(n) = \sum_{i=0}^d a_i n^i, ~ (a_d > 0) = \begin{cases} O(n^k), & k \ge d \\ \Omega(n^k), & k \le d \\ \Theta(n^k), & k = d \end{cases}$

我的批注 使用渐进符号时我们应力求{==精确==}、{==简洁==}

例如对$T(n) = 3 n^2 - 10 n$，应将其写为$T(n) = \Theta(n^2)$

- 不应写成$T(n) = O(n^{2.5})$或$T(n) = \Omega(n^{1.5})$，这不精确，虽然是对的
- 也不应写成$T(n) = \Theta(n^2 + n)$，这不简洁，虽然也是对的

<!-- slide data-notes="" -->

##### (不)等式中的渐进记号

---

若渐进记号单独出现在等号右边，如$3 n^2 = \Theta(n^2)$，表示属于$\in$

若渐进记号作为表达式中的一项，如$T(n) \le T(n-1) + \Theta(n)$，表示{==匿名函数==}，即存在$f(n) \in \Theta(n)$使得$T(n) \le T(n-1) + f(n)$

- 函数名$f$及其精确形式不重要，不影响$T(n)$的渐进行为
- 实际求$T(n)$时，根据问题对$\Theta(n)$予以具体化

<div class="top2"></div>

多匿名函数，如$2 n^2 + 3 n + 1 = 2 n^2 + \Theta(n) = \Theta(n^2)$

- 第一个等号表示存在$f(n) \in \Theta(n)$使得$2 n^2 + 3 n + 1 = 2 n^2 + f(n)$
- 第二个等号表示对任意$g(n) \in \Theta(n)$，存在$h(n) \in \Theta(n^2)$使得$2 n^2 + g(n) = h(n)$，先左后右，右适配左

<div class="top2"></div>

$\sum_{i=1}^n \Theta (i)$表示$\sum_{i=1}^n (a i + b)$，而不是$\Theta (1) + \Theta (2) + \cdots + \Theta (n)$

<!-- slide vertical=true data-notes="" -->

##### 表示常量的渐进记号

---

通常用$n$表示问题输入的规模，我们关心$n \rightarrow \infty$时的情况

若写成$O(g(m))$，则表示的是关心$m \rightarrow \infty$时的$g(m)$的增长速度

如何理解$f(n) = O(1)$？

- 此时$g(n) = n^0 = 1$，$f(n)$有个正常数为其渐进上界
- 通常$O(1)$表示常量时间复杂度，算法执行时间与问题规模$n$无关

<div class="top2"></div>

如何理解当$n<3$时$T(n) = O(1)$？

- $n<3$的限定和$O$的渐进性是个矛盾，因为$O$对应的$n_0$可能大于$3$
- 此时忽略$O$的渐进意义，即存在正常数$c$使得当$n<3$时$T(n) \le c$

<div class="top2"></div>

我的批注 若不致引起误解，尽可能滥用(abuse)符号，可以简化表达

<!-- slide data-notes="" -->

##### 非紧确渐进上界

---

非紧确渐进上界$o(g(n))$定义如下：

$$
\begin{align*}
    \quad o(g(n)) = \{ f(n) \mid \class{blue}{\forall c > 0} ~ \exists n_0 > 0 ~ \forall n \ge n_0 : 0 \le f(n) \class{blue}{<} c g(n) \}
\end{align*}
$$

<div class="top-1"></div>

对比渐进上界$O(g(n))$，两点区别

1. $\class{blue}{\exists} c > 0$变成了$\class{blue}{\forall} c > 0$
2. $0 \le f(n) \class{blue}{\le} c g(n)$变成了$0 \le f(n) \class{blue}{<} c g(n)$

<div class="top2"></div>

顾名思义，$o(g(n)) = O(g(n)) \setminus \Theta(g(n))$

- 对$c$任取某个固定的正常数，可知$o \subseteq O$
- $\forall c > 0 : f(n) < c g(n) \Longleftrightarrow \not \exists c > 0 : f(n) \ge c g(n)$，从而$o \cap \Theta = \emptyset$

<div class="top2"></div>

例：$2n = o(n^2)$，$2n \ne o(n)$

<!-- slide vertical=true data-notes="" -->

##### 非紧确渐进上界

---

<div class="top2"></div>

$$
\begin{align}
    \quad o(g(n)) & = \{ f(n) \mid \class{blue}{\forall c > 0} ~ \exists n_0 > 0 ~ \forall n \ge n_0 : 0 \le f(n) \class{blue}{<} c g(n) \} \nonumber \\[4px]
    \label{eq: def}
    & \Longrightarrow \class{blue}{\forall c > 0} : 0 \le \lim_{n \rightarrow \infty} \frac{f(n)}{g(n)} < c \Longleftrightarrow \lim_{n \rightarrow \infty} \frac{f(n)}{g(n)} = 0
\end{align}
$$

<div class="top-2"></div>

$f(n) = o(g(n))$表示在渐进意义下$f(n)$相对$g(n)$变得微不足道了

<div class="top2"></div>

- 有的书上会采用式(\ref{eq: def})的定义，在$f(n)$渐进非负的前提下两式等价
- 根据极限定义，对任意$c > 0$存在$n_0$使得对$\forall n \ge n_0$有$|\frac{f(n)}{g(n)} - 0| < c$，若$f(n)$渐进非负，则$f(n) < c g(n)$

<div class="top2"></div>

对数函数 < 多项式函数 < 指数函数：

- 对$\forall a > 1$和$b$有$\lim_{n \rightarrow \infty} \frac{n^b}{a^n} = 0$，于是$n^b = o(a^n)$
- 对$\forall a > 0$和$b$有$\lim_{n \rightarrow \infty} \frac{\lg^b n}{n^a} = 0$，于是$\lg^b n = o(n^a)$

<!-- slide data-notes="" -->

##### 非紧确渐进下界

---

非紧确渐进下界$\omega(g(n))$对比$\Omega(g(n))$同样是两点区别

$$
\begin{align*}
    \quad \omega(g(n)) & = \{ f(n) \mid \class{blue}{\forall c > 0} ~ \exists n_0 > 0 ~ \forall n \ge n_0 : 0 \le c g(n) \class{blue}{<} f(n) \} \\[4px]
    \label{eq: def2}
    & \Longrightarrow \class{blue}{\forall c > 0} : c < \lim_{n \rightarrow \infty} \frac{f(n)}{g(n)} \Longleftrightarrow \lim_{n \rightarrow \infty} \frac{f(n)}{g(n)} = \infty
\end{align*}
$$

<div class="top-1"></div>

$f(n) = \omega(g(n))$表示在渐进意义下$f(n)$相对$g(n)$可变得任意大

对称的有$\omega(g(n)) = \Omega(g(n)) \setminus \Theta(g(n))$

- 对$c$任取某个固定的正常数，可知$\omega \subseteq \Omega$
- $\forall c > 0 : c g(n) < f(n) \Longleftrightarrow \not \exists c > 0 : f(n) \le c g(n)$，从而$\omega \cap \Theta = \emptyset$

<div class="top2"></div>

例：$2 n^2 = \omega (n)$，$2 n^2 \ne \omega(n^2)$

<!-- slide data-notes="" -->

##### 非紧确渐进界

---

$d$阶多项式$p(n) = a_d n^d + a_{d-1} n^{d-1} + \cdots + a_1 n + a_0$，其中$a_d > 0$

易知有$\frac{p(n)}{n^d} = a_d + \frac{a_{d-1}}{n} + \cdots + \frac{a_1}{n^{d-1}} + \frac{a_0}{n^d} \triangleq q(n) \xrightarrow{~ n \rightarrow \infty ~} a_d$

若$k > d$，$\lim_{n \rightarrow \infty} \frac{p(n)}{n^k} = \lim_{n \rightarrow \infty} \frac{q(n)}{n^{k-d}} = 0 \Longrightarrow p(n) = o(n^k)$

若$k < d$，$\lim_{n \rightarrow \infty} \frac{p(n)}{n^k} = \lim_{n \rightarrow \infty} q(n) n^{d-k} = \infty \Longrightarrow p(n) = \omega(n^k)$

综上，最高项系数为正的$d$阶多项式$p(n) = \begin{cases} O(n^k), & k \ge d \\ \Omega(n^k), & k \le d \\ \Theta(n^k), & k = d \\ o(n^k), & k > d \\ \omega(n^k), & k < d \end{cases}$

<!-- slide data-notes="" -->

##### 限界函数的相互关系

---

<div class="threelines left8 righta">

|      | 等价关系 |   >   | 非严格偏序关系 |  >  | 严格偏序关系 |
| :--: | :------: | :---: | :------------: | :-: | :----------: |
| 函数 | $\Theta$ |  $O$  |    $\Omega$    | $o$ |   $\omega$   |
|  数  |   $=$    | $\le$ |     $\ge$      | $<$ |     $>$      |

</div>

基于此类比易知有

<div class="threelines left8 righta">

|          | 自反性 | 对称性 | 转置对称性 | 传递性 |
| :------: | :----: | :----: | :--------: | :----: |
| $\Theta$ |   ✓    |   ✓    |     ✗      |   ✓    |
|   $O$    |   ✓    |   ✗    |     ✓      |   ✓    |
| $\Omega$ |   ✓    |   ✗    |     ✓      |   ✓    |
|   $o$    |   ✗    |   ✗    |     ✓      |   ✓    |
| $\omega$ |   ✗    |   ✗    |     ✓      |   ✓    |

</div>

<!-- slide vertical=true data-notes="" -->

##### 自反性

---

$f(n) = \Theta(f(n))$，$f(n) = O(f(n))$，$f(n) = \Omega(f(n))$

<!-- slide data-notes="" -->

##### 一些例子

---

例：$f(n) = O(g(n)) \rightarrow g(n) = O(f(n))$是否成立？

该对称性不成立，$n = O(n^2)$，但$n^2 \ne O(n)$

例：$2^{n+1} = O(2^n)$，$2^{2n} \ne O(2^n)$

因为$0 \le 2^{n+1} \le 2 \cdot 2^n$，取$c=2$、$n_0 = 1$即可

反设若成立，则存在正常数$c$使得$2^{2n} = 2^n \cdot 2^n \le c \cdot 2^n$渐进成立，由此亦可得出$f(n) = O(g(n)) \rightarrow 2^{f(n)} = O(2^{g(n)})$不成立

<div class="top4"></div>

<!-- slide vertical=true data-notes="" -->

##### 一些例子

---

例：$f(n) = O((f(n))^2)$是否成立？

不成立，

确定下界函数时，应找阶最大的$g(n)$，称为{==紧确下界==}

- $3n^2+2 = \Omega(n)$是松散的下界
- $3n^2+2 = \Omega(n^2)$是紧确的下界

<!-- slide data-notes="" -->

##### 一些例子

---

<!-- slide vertical=true data-notes="" -->

##### 一些例子

---

求证：$6 n^3 \ne \Theta (n^2)$

证明：反证法，假设$6 n^3 = \Theta (n^2)$

则存在正常数$c_2$和$n_0$，使得对$\forall n \ge n_0$有$6 n^3 \le c_2 n^2$

两边同除以$n^2$得$n \le c_2 / 6$，显然这不可能对任意大的$n$都成立

<!-- slide data-notes="" -->

##### 限界函数的性质

---

传递性

代表{==算法在最坏情况下的复杂度==}

确定上界函数时，应找阶最小的$g(n)$，称为{==紧确上界==}

- $3n+2 = O(n^2)$是松散的上界
- $3n+2 = O(n)$是紧确的上界
